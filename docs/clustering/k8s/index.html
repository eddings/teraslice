<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>K8s Clustering · Teraslice</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;Teraslice supports the use of Kubernetes as a cluster manager.  The supported&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="K8s Clustering · Teraslice"/><meta property="og:type" content="website"/><meta property="og:url" content="https://terascope.github.io/teraslice/index.html"/><meta property="og:description" content="&lt;p&gt;Teraslice supports the use of Kubernetes as a cluster manager.  The supported&lt;/p&gt;
"/><meta property="og:image" content="https://terascope.github.io/teraslice/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://terascope.github.io/teraslice/img/docusaurus.png"/><link rel="shortcut icon" href="/teraslice/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://terascope.github.io/teraslice/blog/atom.xml" title="Teraslice Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://terascope.github.io/teraslice/blog/feed.xml" title="Teraslice Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/teraslice/css/main.css"/><script src="/teraslice/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/teraslice/"><img class="logo" src="/teraslice/img/logo.png" alt="Teraslice"/><h2 class="headerTitleWithLogo">Teraslice</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/teraslice/docs/overview" target="_self">Docs</a></li><li class=""><a href="/teraslice/docs/api" target="_self">API</a></li><li class=""><a href="/teraslice/docs/examples" target="_self">Examples</a></li><li class=""><a href="/teraslice/docs/packages" target="_self">Packages</a></li><li class=""><a href="/teraslice/help" target="_self">Help</a></li><li class=""><a href="/teraslice/blog/" target="_self">Blog</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Clustering</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Overview</h3><ul class=""><li class="navListItem"><a class="navItem" href="/teraslice/docs/overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/teraslice/docs/getting-started">Getting Started</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Configuration</h3><ul class=""><li class="navListItem"><a class="navItem" href="/teraslice/docs/configuration/teraslice">Teraslice</a></li><li class="navListItem"><a class="navItem" href="/teraslice/docs/configuration/ops">Operations</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Clustering</h3><ul class=""><li class="navListItem navListItemActive"><a class="navItem" href="/teraslice/docs/clustering/k8s">K8s</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Development</h3><ul class=""><li class="navListItem"><a class="navItem" href="/teraslice/docs/development/overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/teraslice/docs/development/releases">Releases</a></li><li class="navListItem"><a class="navItem" href="/teraslice/docs/development/tests">Tests</a></li><li class="navListItem"><a class="navItem" href="/teraslice/docs/development/e2e-tests">End-to-End Tests</a></li><li class="navListItem"><a class="navItem" href="/teraslice/docs/development/contributing">Contributing</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">K8s Clustering</h1></header><article><div><span><p>Teraslice supports the use of Kubernetes as a cluster manager.  The supported
versions of Kubernetes is:</p>
<ul>
<li><code>1.10.*</code></li>
</ul>
<h1><a class="anchor" aria-hidden="true" id="setup"></a><a href="#setup" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setup</h1>
<p>You need Elasticsearch running and listening on a port accessible by the
Teraslice master and worker nodes.  In the case of minikube based deployments
(dev/test only) you'll need to make ES listen on your VirtualBox interface.  The
IP address of that interface is what you need to set as:</p>
<pre><code class="hljs">`terafoundation.connectors.elasticsearch.default.host`
</code></pre>
<p>in both the <code>teraslice-master</code> and <code>teraslice-worker</code> ConfigMaps.</p>
<h2><a class="anchor" aria-hidden="true" id="default-serviceaccount-binding"></a><a href="#default-serviceaccount-binding" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>default</code> ServiceAccount Binding</h2>
<p>In order to run Teraslice Jobs in your Kubernetes cluster the Teraslice master
node will need the ability create, list and delete Kubernetes Jobs, Deployments,
Services and Pods.  Teraslice has the ability to run in an isolated Kubernetes
namespace so users don't have to grant broad permissions to the Teraslice
master.  Users can configure the Teraslice master to use a specific namespace
with the <code>kubernetes_namespace</code> configuration option.  Users would then have
to create a Kubernetes <code>Role</code> and <code>RoleBinding</code> as shown below:</p>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">kind:</span> <span class="hljs-string">Role</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">rbac.authorization.k8s.io/v1</span>
<span class="hljs-attr">metadata:</span>
<span class="hljs-attr">  name:</span> <span class="hljs-string">teraslice-all-&lt;NAMESPACE&gt;</span>
<span class="hljs-attr">  namespace:</span> <span class="hljs-string">&lt;NAMESPACE&gt;</span>
<span class="hljs-attr">rules:</span>
<span class="hljs-attr">  - apiGroups:</span> <span class="hljs-string">["*"]</span>
<span class="hljs-attr">    resources:</span> <span class="hljs-string">["*"]</span>
<span class="hljs-attr">    verbs:</span> <span class="hljs-string">["*"]</span>
</code></pre>
<pre><code class="hljs css language-yaml"><span class="hljs-attr">kind:</span> <span class="hljs-string">RoleBinding</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">rbac.authorization.k8s.io/v1</span>
<span class="hljs-attr">metadata:</span>
<span class="hljs-attr">  name:</span> <span class="hljs-string">teraslice-all-&lt;NAMESPACE&gt;</span>
<span class="hljs-attr">  namespace:</span> <span class="hljs-string">&lt;NAMESPACE&gt;</span>
<span class="hljs-attr">subjects:</span>
<span class="hljs-attr">  - kind:</span> <span class="hljs-string">ServiceAccount</span>
<span class="hljs-attr">    name:</span> <span class="hljs-string">default</span>
<span class="hljs-attr">    namespace:</span> <span class="hljs-string">&lt;NAMESPACE&gt;</span>
<span class="hljs-attr">roleRef:</span>
<span class="hljs-attr">  kind:</span> <span class="hljs-string">Role</span>
<span class="hljs-attr">  name:</span> <span class="hljs-string">teraslice-all-&lt;NAMESPACE&gt;</span>
<span class="hljs-attr">  apiGroup:</span> <span class="hljs-string">"rbac.authorization.k8s.io"</span>
</code></pre>
<p>Currently, Teraslice interacts with Kubernetes using the
<code>default ServiceAccount</code> in the configured namespace.</p>
<h2><a class="anchor" aria-hidden="true" id="master-deployment"></a><a href="#master-deployment" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Master Deployment</h2>
<p>The Teraslice master node needs to be deployed in k8s by the user.  It should
be deployed in a namespace mentioned above.  It should have a k8s service that
exposes port <code>5678</code> for user interaction.  The cluster master will only show
up in cluster state if it is deployed with the label <code>clusterName</code> set to the
clustername modified as follows:</p>
<pre><code class="hljs css language-javascript">clusterName.replace(<span class="hljs-regexp">/[^a-zA-Z0-9_\-.]/g</span>, <span class="hljs-string">'_'</span>).substring(<span class="hljs-number">0</span>, <span class="hljs-number">63</span>)
</code></pre>
<p>It is not necessary that the master be in cluster state for Teraslice to work,
it's just kind of nice to have.</p>
<h1><a class="anchor" aria-hidden="true" id="kubernetes-specific-configuration-settings"></a><a href="#kubernetes-specific-configuration-settings" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Kubernetes Specific Configuration Settings</h1>
<p>The table below shows the Teraslice configuration settings added
to support k8s based Teraslice deployments.</p>
<table>
<thead>
<tr><th style="text-align:center">Configuration</th><th style="text-align:center">Description</th><th style="text-align:center">Type</th><th style="text-align:center">Notes</th></tr>
</thead>
<tbody>
<tr><td style="text-align:center">assets_volume</td><td style="text-align:center">Name of kubernetes volume to be shared across all pods, where Teraslice assets will be stored</td><td style="text-align:center">String</td><td style="text-align:center">optional</td></tr>
<tr><td style="text-align:center">kubernetes_image</td><td style="text-align:center">Name of docker image, default: <code>teraslice:k8sdev</code></td><td style="text-align:center">String</td><td style="text-align:center">optional</td></tr>
<tr><td style="text-align:center">kubernetes_image_pull_secret</td><td style="text-align:center">Secret used to pull docker images from private repo</td><td style="text-align:center">String</td><td style="text-align:center">optional</td></tr>
<tr><td style="text-align:center">kubernetes_config_map_name</td><td style="text-align:center">Name of the configmap used by worker and execution_controller containers for config.  If this is not provided, the default will be <code>&lt;CLUSTER_NAME&gt;-worker</code></td><td style="text-align:center">String</td><td style="text-align:center">optional</td></tr>
<tr><td style="text-align:center">kubernetes_namespace</td><td style="text-align:center">Kubernetes Namespace that Teraslice will run in, default namespace: 'default'</td><td style="text-align:center">String</td><td style="text-align:center">optional</td></tr>
</tbody>
</table>
<p>Note that the <code>assets_volume</code> should also be mounted to your Teraslice master pod.</p>
<h1><a class="anchor" aria-hidden="true" id="teraslice-job-properties"></a><a href="#teraslice-job-properties" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Teraslice Job Properties</h1>
<p>Support for Kubernetes based clustering adds additional properties to a
Teraslice job definition.  These are outlined below.</p>
<h2><a class="anchor" aria-hidden="true" id="resources"></a><a href="#resources" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Resources</h2>
<p>It is possible to set CPU and memory resource constraints for your Teraslice
workers that translate to Kubernetes resource constraints.  Currently you
can specify optional integer values on your job as shown below. The <code>cpu</code>
setting is in vcores and the <code>memory</code> setting is in bytes.</p>
<pre><code class="hljs"><span class="hljs-string">"cpu"</span>: <span class="hljs-number">1</span>,
<span class="hljs-string">"memory"</span>: <span class="hljs-number">2147483648</span>
</code></pre>
<p>Setting <code>cpu</code> will result in the Kubernetes <code>resources.requests.cpu</code> and
<code>resources.limit.cpu</code> being set to <code>cpu</code> value provided.  Setting <code>memory</code>
will result in the Kubernetes <code>resources.requests.memory</code> and
<code>resources.limit.memory</code> being set to the <code>memory</code> value provided. See the
<a href="https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/">Kubernetes Resource docs</a>
for further details on how Kubernetes interprets these values.</p>
<h2><a class="anchor" aria-hidden="true" id="node-affinity-by-targets"></a><a href="#node-affinity-by-targets" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Node Affinity by Targets</h2>
<p>If you need the workers (and execution controller) of your job to execute on
specific set of nodes, you can use the Teraslice <code>targets</code> property on your
job. You can specify one or more targets that will use <a href="https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity">Kubernetes Node Affinity</a>
to force nodes onto specific nodes.  The targets specified here will be required
using <code>requiredDuringSchedulingIgnoredDuringExecution</code>.</p>
<pre><code class="hljs"><span class="hljs-string">"targets"</span>: [
    {<span class="hljs-string">"key"</span>: <span class="hljs-string">"zone"</span>, <span class="hljs-string">"value"</span>: <span class="hljs-string">"west"</span>}
],
</code></pre>
<p>For each entry in <code>targets</code> you provide, there will be a corresponding
Kubernetes constraint, like the one shown below, added to your workers.</p>
<pre><code class="hljs"><span class="hljs-symbol">        nodeSelectorTerms:</span>
        - matchExpressions:
          - key: <span class="hljs-params">&lt;KEY&gt;</span>
<span class="hljs-symbol">            operator:</span> In
<span class="hljs-symbol">            values:</span>
            - <span class="hljs-params">&lt;VALUE&gt;</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="attach-existing-volumes"></a><a href="#attach-existing-volumes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Attach existing volumes</h2>
<p>One or more volumes can be specified on your job and these volumes will be
attached to your worker and execution controller pods at runtime.  The volumes
and their volume claims must exist prior to job execution.  Note that the <code>name</code>
property should be the name of the Kubernetes <code>persistentVolumeClaim</code>.  The
<code>path</code> is where the volume will be mounted within the containers in your pod.</p>
<pre><code class="hljs"><span class="hljs-string">"volumes"</span>: [
    {<span class="hljs-string">"name"</span>: <span class="hljs-string">"teraslice-data1"</span>, <span class="hljs-string">"path"</span>: <span class="hljs-string">"/data"</span>}
],
</code></pre>
<h1><a class="anchor" aria-hidden="true" id="makefile"></a><a href="#makefile" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Makefile</h1>
<p>There is a <code>Makefile</code> I use to help bootstrap Teraslice and do repetitive tasks,
you can type <code>make</code> to see all of the possible targets.</p>
<p>The standard minikube based dev workflow is:</p>
<pre><code class="hljs"><span class="hljs-attr">minikube</span> <span class="hljs-string">start</span>
<span class="hljs-attr">cd</span> <span class="hljs-string">examples/k8s</span>
<span class="hljs-attr">export</span> <span class="hljs-string">NAMESPACE=ts-dev1</span>
<span class="hljs-attr">export</span> <span class="hljs-string">TERASLICE_K8S_IMAGE=teraslice-k8sdev:1</span>
<span class="hljs-attr">make</span> <span class="hljs-string">build</span>
<span class="hljs-attr">make</span> <span class="hljs-string">setup-all</span>
<span class="hljs-attr">make</span> <span class="hljs-string">show</span>
<span class="hljs-attr">make</span> <span class="hljs-string">register</span>
<span class="hljs-attr">make</span> <span class="hljs-string">example</span>
</code></pre>
<p>then when you need to make another change to Teraslice, redeploy and run a new
job:</p>
<pre><code class="hljs"><span class="hljs-attr">make</span> <span class="hljs-string">destroy</span>
<span class="hljs-attr">export</span> <span class="hljs-string">TERASLICE_K8S_IMAGE=teraslice-k8sdev:2</span>
<span class="hljs-attr">make</span> <span class="hljs-string">build</span>
<span class="hljs-attr">make</span> <span class="hljs-string">setup</span>
<span class="hljs-attr">make</span> <span class="hljs-string">register</span>
<span class="hljs-attr">make</span> <span class="hljs-string">example</span>
</code></pre>
<p>Note: If you build your images straight into k8s you don't need to increment
the version number on TERASLICE_K8s_IMAGE.  You can do this by configuring
your local docker to use minikube by running the following command:
<code>eval $(minikube docker-env)</code>.  This can get messy in a number of ways if
you're not carefule though (e.g: if you forget your shell is configured this
way or you accumulate too many images in your minikube)</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/teraslice/docs/configuration/ops"><span class="arrow-prev">← </span><span>Operations</span></a><a class="docs-next button" href="/teraslice/docs/development/overview"><span>Overview</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#default-serviceaccount-binding"><code>default</code> ServiceAccount Binding</a></li><li><a href="#master-deployment">Master Deployment</a></li><li><a href="#resources">Resources</a></li><li><a href="#node-affinity-by-targets">Node Affinity by Targets</a></li><li><a href="#attach-existing-volumes">Attach existing volumes</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/teraslice/" class="nav-home"></a><div><h5>Docs</h5><a href="/teraslice/docs/en/getting-started.html">Getting Started</a><a href="/teraslice/docs/en/packages.html">Packages</a><a href="/teraslice/docs/en/apis.html">API Reference</a></div><div><h5>More</h5><a href="/teraslice/blog">Blog</a><a href="https://github.com/terascope/teraslice">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/terascope/teraslice/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2019 Terascope, LLC</section></footer></div></body></html>